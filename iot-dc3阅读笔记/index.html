<!DOCTYPE html>

<html lang="zh-CN">

<script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，崩溃啦！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，又好了！", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
</script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2114287505938813"
     crossorigin="anonymous"></script>

<head>
  
  <meta name="baidu-site-verification" content="code-J1Qg17G6wT" />
  <title>iot-dc3阅读笔记 - 一只会飞的旺旺-IT技术分享</title>
  <meta charset="UTF-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ENFHSEQW2K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ENFHSEQW2K');
</script>
  
    <!-- Site Verification -->
    <meta name="google-site-verification" content="FHLjkCq3_Lc-cEgxXN8BfR4rfC9omgFmaAB1vhSrJyw" />


    <!-- Site Verification -->
    <meta name="baidu-site-verification" content="code-pSK313Q8yf" />

  <link rel="shortcut icon" href="/images/head/a.webp" type="image/png" />
  <meta name="description" content="iot-dc3项目阅读笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="iot-dc3阅读笔记">
<meta property="og:url" content="https://www.wangwangit.com/iot-dc3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="一只会飞的旺旺-IT技术分享">
<meta property="og:description" content="iot-dc3项目阅读笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702151346536.png">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702154506368.png">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702154521066.png">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702160343549.png">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702161250757.png">
<meta property="og:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702163901323.png">
<meta property="article:published_time" content="2024-06-30T22:25:00.000Z">
<meta property="article:modified_time" content="2025-03-05T07:40:53.867Z">
<meta property="article:author" content="一只会飞的旺旺">
<meta property="article:tag" content="物联网">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702151346536.png">
  <link rel="stylesheet" href="https://unpkg.com/highlight.js@9.15.8/styles/atom-one-dark.css" crossorigin>
  <link rel="stylesheet" href="/lib/mdui_043tiny/css/mdui.css">
  <link rel="stylesheet" href="/lib/iconfont/iconfont.css">
  <link rel="stylesheet" href="/lib/fancybox/css/jquery.fancybox.min.css">
  <link rel="stylesheet" href="https://unpkg.com/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css">
  
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2421060_8z08qcz5sq3.css">
  
  <link rel="stylesheet" href="/css/style.css?v=1741160487246">
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="一只会飞的旺旺-IT技术分享" type="application/atom+xml">
</head>

<body class="mdui-drawer-body-left">
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ENFHSEQW2K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ENFHSEQW2K');
</script>
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-color: #3b75d5; box-shadow: inset 0 0 10px #BF360C;"></div>
    <!--<div class="nexmoe-small" style="background-image: url(/images/background/lihui.webp)"></div>-->
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" rel="external nofollow noreferrer" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="一只会飞的旺旺" class="mdui-btn mdui-btn-icon"><img src="/images/head/a.webp" alt="一只会飞的旺旺"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <script src="/js/popup.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ENFHSEQW2K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ENFHSEQW2K');
</script>
<div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="一只会飞的旺旺">
            <img src="/images/head/a.webp" alt="一只会飞的旺旺" alt="一只会飞的旺旺">
        </a>
    </div>
    <div class="nexmoe-count">
        <div class="nexmoe-count-item"><span>文章</span>154 <div class="item-radius"></div><div class="item-radius item-right"></div> </div>
        <div class="nexmoe-count-item"><span>标签</span>132<div class="item-radius"></div><div class="item-radius item-right"></div></div>
        <div class="nexmoe-count-item"><span>分类</span>7<div class="item-radius"></div><div class="item-radius item-right"></div></div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-meishi"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/archives.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-hanbao1"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/friend.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-tangguo"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/bookmark.html" title="书签分享">
            <i class="mdui-list-item-icon nexmoefont icon-zhediejiantou"></i>
            <div class="mdui-list-item-content">
                书签分享
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于旺旺">
            <i class="mdui-list-item-icon nexmoefont icon-jiubei1"></i>
            <div class="mdui-list-item-content">
                关于旺旺
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/atom.xml" title="RSS">
            <i class="mdui-list-item-icon nexmoefont icon-rss"></i>
            <div class="mdui-list-item-content">
                RSS
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
  
  
<!-- 站内搜索 -->

<div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search" >
        <form id="search-form">
            <label><input type="text" id="local-search-input" name="q" results="0" placeholder="站内搜索" class="input form-control" autocomplete="off" autocorrect="off"/></label>
            <!-- 清空/重置搜索框 -->
            <i class="fa fa-times" onclick="resetSearch()"></i>
        </form>
    </div>
    <div id="local-search-result"></div> <!-- 搜索结果区 -->
    <!-- <p class='no-result'></p> 无匹配时显示，注意在 CSS 中设置默认隐藏 -->
</div>


  
  <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="http://wpa.qq.com/msgrd?v=3&uin=1249217495&site=qq&menu=yes" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(64, 196, 255);background-color: rgba(64, 196, 255, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="mailto:1249217495@vip.qq.com" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: 'mail'}" style="color: rgb(235, 87, 87);background-color: rgba(235, 87, 87, .1);">
            <i class="nexmoefont icon-mail-fill"></i>
        </a><a class="mdui-ripple" href="https://github.com/wangwangit" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(36, 123, 160);background-color: rgba(36, 123, 160, .15);">
            <i class="nexmoefont icon-github"></i>
        </a><a class="mdui-ripple" href="https://ali.wangwangit.com" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: '资源盘'}" style="color: rgb(0, 168, 150);background-color: rgba(0, 168, 150, .15);">
            <i class="nexmoefont icon-hanbao"></i>
        </a><a class="mdui-ripple" href="http://tool.wangwangit.com" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: '工具站'}" style="color: rgb(255, 159, 28);background-color: rgba(255, 159, 28, .15);">
            <i class="nexmoefont icon-cola"></i>
        </a><a class="mdui-ripple" href="https://shop.wangwangit.com" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: '商店'}" style="color: rgb(126, 214, 223);background-color: rgba(126, 214, 223, .15);">
            <i class="nexmoefont icon-fuzhi"></i>
        </a><a class="mdui-ripple" href="http://video.wangwangit.com" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: '影视站'}" style="color: rgb(108, 92, 231);background-color: rgba(108, 92, 231, .15);">
            <i class="nexmoefont icon-jiubei"></i>
        </a><a class="mdui-ripple" href="http://chat.wangzai.top" rel="external nofollow noreferrer" target="_blank" mdui-tooltip="{content: 'AI站'}" style="color: rgb(178, 190, 195);background-color: rgba(178, 190, 195, .15);">
            <i class="nexmoefont icon-meishi"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/AI/">AI</a>
          <span class="category-list-count">29</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Java/">Java</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/博客/">博客</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/开发/">开发</a>
          <span class="category-list-count">51</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/教程/">教程</a>
          <span class="category-list-count">27</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/网站/">网站</a>
          <span class="category-list-count">15</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/软件/">软件</a>
          <span class="category-list-count">23</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/AI/" style="font-size: 17.78px;">AI</a> <a href="/tags/AI%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">AI工具</a> <a href="/tags/Ai/" style="font-size: 10px;">Ai</a> <a href="/tags/Alist/" style="font-size: 10px;">Alist</a> <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Apple/" style="font-size: 10px;">Apple</a> <a href="/tags/Aria2/" style="font-size: 10px;">Aria2</a> <a href="/tags/Azure/" style="font-size: 11.11px;">Azure</a> <a href="/tags/Baidu/" style="font-size: 10px;">Baidu</a> <a href="/tags/Bing/" style="font-size: 10px;">Bing</a> <a href="/tags/CDN/" style="font-size: 12.22px;">CDN</a> <a href="/tags/CORS/" style="font-size: 10px;">CORS</a> <a href="/tags/Chat2DB/" style="font-size: 10px;">Chat2DB</a> <a href="/tags/Chatgpt/" style="font-size: 18.89px;">Chatgpt</a> <a href="/tags/Clash/" style="font-size: 10px;">Clash</a> <a href="/tags/Claude/" style="font-size: 11.11px;">Claude</a> <a href="/tags/Claude3/" style="font-size: 10px;">Claude3</a> <a href="/tags/CloudFlare/" style="font-size: 10px;">CloudFlare</a> <a href="/tags/Cloudflare/" style="font-size: 11.11px;">Cloudflare</a> <a href="/tags/Command/" style="font-size: 10px;">Command</a> <a href="/tags/Copilot/" style="font-size: 10px;">Copilot</a> <a href="/tags/DeepSeek-R1/" style="font-size: 10px;">DeepSeek R1</a> <a href="/tags/Docker/" style="font-size: 14.44px;">Docker</a> <a href="/tags/Domain/" style="font-size: 10px;">Domain</a> <a href="/tags/EGADS/" style="font-size: 10px;">EGADS</a> <a href="/tags/Easypoi/" style="font-size: 10px;">Easypoi</a> <a href="/tags/Edge/" style="font-size: 13.33px;">Edge</a> <a href="/tags/Elasticsearch/" style="font-size: 11.11px;">Elasticsearch</a> <a href="/tags/Eureka/" style="font-size: 10px;">Eureka</a> <a href="/tags/ExpiringMap/" style="font-size: 10px;">ExpiringMap</a> <a href="/tags/GIF/" style="font-size: 10px;">GIF</a> <a href="/tags/GPT4/" style="font-size: 11.11px;">GPT4</a> <a href="/tags/Git/" style="font-size: 14.44px;">Git</a> <a href="/tags/Github/" style="font-size: 16.67px;">Github</a> <a href="/tags/Google/" style="font-size: 12.22px;">Google</a> <a href="/tags/Hexo/" style="font-size: 12.22px;">Hexo</a> <a href="/tags/Hosts/" style="font-size: 10px;">Hosts</a> <a href="/tags/IDEA/" style="font-size: 10px;">IDEA</a> <a href="/tags/InfluxDB/" style="font-size: 11.11px;">InfluxDB</a> <a href="/tags/JSON/" style="font-size: 10px;">JSON</a> <a href="/tags/Java/" style="font-size: 14.44px;">Java</a> <a href="/tags/JetBrains/" style="font-size: 11.11px;">JetBrains</a> <a href="/tags/Jetbrains/" style="font-size: 10px;">Jetbrains</a> <a href="/tags/KPlayer/" style="font-size: 10px;">KPlayer</a> <a href="/tags/Kibana/" style="font-size: 10px;">Kibana</a> <a href="/tags/Kubernetes/" style="font-size: 10px;">Kubernetes</a> <a href="/tags/Linux/" style="font-size: 12.22px;">Linux</a> <a href="/tags/Logstash/" style="font-size: 10px;">Logstash</a> <a href="/tags/MarkDown/" style="font-size: 10px;">MarkDown</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/Minio/" style="font-size: 10px;">Minio</a> <a href="/tags/Mqtt/" style="font-size: 10px;">Mqtt</a> <a href="/tags/MySQL/" style="font-size: 11.11px;">MySQL</a> <a href="/tags/Mybatis/" style="font-size: 11.11px;">Mybatis</a> <a href="/tags/Navicat/" style="font-size: 10px;">Navicat</a> <a href="/tags/Netflix/" style="font-size: 10px;">Netflix</a> <a href="/tags/Netplan/" style="font-size: 10px;">Netplan</a> <a href="/tags/Nginx/" style="font-size: 12.22px;">Nginx</a> <a href="/tags/Office/" style="font-size: 10px;">Office</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/OracleCloud/" style="font-size: 10px;">OracleCloud</a> <a href="/tags/PDF/" style="font-size: 10px;">PDF</a> <a href="/tags/PicGo/" style="font-size: 10px;">PicGo</a> <a href="/tags/PowerShell/" style="font-size: 11.11px;">PowerShell</a> <a href="/tags/RabbitMQ/" style="font-size: 11.11px;">RabbitMQ</a> <a href="/tags/Reddit/" style="font-size: 10px;">Reddit</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Ribbon/" style="font-size: 10px;">Ribbon</a> <a href="/tags/SciHub/" style="font-size: 10px;">SciHub</a> <a href="/tags/Screw/" style="font-size: 10px;">Screw</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/Slack/" style="font-size: 11.11px;">Slack</a> <a href="/tags/Spring/" style="font-size: 15.56px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 10px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 14.44px;">SpringCloud</a> <a href="/tags/SpringSecurity/" style="font-size: 11.11px;">SpringSecurity</a> <a href="/tags/Tamperonkey/" style="font-size: 10px;">Tamperonkey</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/Vps/" style="font-size: 11.11px;">Vps</a> <a href="/tags/WSL/" style="font-size: 10px;">WSL</a> <a href="/tags/Warp/" style="font-size: 10px;">Warp</a> <a href="/tags/WebRTC/" style="font-size: 10px;">WebRTC</a> <a href="/tags/Windows/" style="font-size: 20px;">Windows</a> <a href="/tags/Windows-Terminal/" style="font-size: 11.11px;">Windows Terminal</a> <a href="/tags/WizTree/" style="font-size: 10px;">WizTree</a> <a href="/tags/ZLibrary/" style="font-size: 10px;">ZLibrary</a> <a href="/tags/ai/" style="font-size: 10px;">ai</a> <a href="/tags/frp/" style="font-size: 10px;">frp</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/prompt/" style="font-size: 10px;">prompt</a> <a href="/tags/%E4%B8%B4%E6%97%B6%E9%82%AE%E7%AE%B1/" style="font-size: 10px;">临时邮箱</a> <a href="/tags/%E4%BA%92%E8%81%94%E7%BD%91/" style="font-size: 10px;">互联网</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/tags/%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" style="font-size: 10px;">使用教程</a> <a href="/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size: 10px;">公众号</a> <a href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" style="font-size: 10px;">内网穿透</a> <a href="/tags/%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" style="font-size: 10px;">包管理器</a> <a href="/tags/%E5%8E%BB%E5%B9%BF%E5%91%8A/" style="font-size: 10px;">去广告</a> <a href="/tags/%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/" style="font-size: 10px;">图像分析</a> <a href="/tags/%E5%B0%8F%E7%99%BD%E7%BE%8A%E4%BA%91%E7%9B%98/" style="font-size: 10px;">小白羊云盘</a> <a href="/tags/%E5%B1%8F%E5%B9%95%E5%85%B1%E4%BA%AB/" style="font-size: 10px;">屏幕共享</a> <a href="/tags/%E5%B7%A5%E4%BD%9C%E5%AE%A4%E5%B8%83%E7%BD%AE/" style="font-size: 10px;">工作室布置</a> <a href="/tags/%E5%BD%95%E5%B1%8F/" style="font-size: 10px;">录屏</a> <a href="/tags/%E6%89%B9%E9%87%8F%E9%87%8D%E5%91%BD%E5%90%8D/" style="font-size: 10px;">批量重命名</a> <a href="/tags/%E6%8E%A5%E7%A0%81/" style="font-size: 10px;">接码</a> <a href="/tags/%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/" style="font-size: 10px;">搜索技巧</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" style="font-size: 10px;">文件管理</a> <a href="/tags/%E6%96%B0%E9%97%BB%E8%B5%84%E8%AE%AF/" style="font-size: 10px;">新闻资讯</a> <a href="/tags/%E6%B5%81%E8%A1%8C%E6%A2%97/" style="font-size: 10px;">流行梗</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6/" style="font-size: 10px;">浏览器插件</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E7%A9%BA%E9%97%B4%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">游戏空间设计</a> <a href="/tags/%E7%89%A9%E8%81%94%E7%BD%91/" style="font-size: 10px;">物联网</a> <a href="/tags/%E7%99%BE%E7%A7%91%E8%AF%8D%E5%85%B8/" style="font-size: 10px;">百科词典</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size: 10px;">直播</a> <a href="/tags/%E7%9F%AD%E9%93%BE%E6%8E%A5/" style="font-size: 10px;">短链接</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E6%B8%85%E7%90%86/" style="font-size: 10px;">系统清理</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F/" style="font-size: 10px;">系统镜像</a> <a href="/tags/%E7%BD%91%E7%AB%99%E8%B5%84%E6%BA%90/" style="font-size: 10px;">网站资源</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%96%87%E5%8C%96/" style="font-size: 10px;">网络文化</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 10px;">翻译</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 11.11px;">脚本</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size: 10px;">自动化</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/" style="font-size: 10px;">虚拟主机</a> <a href="/tags/%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD/" style="font-size: 10px;">视频下载</a> <a href="/tags/%E8%AF%AD%E9%9F%B3%E5%90%88%E6%88%90/" style="font-size: 10px;">语音合成</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">读书笔记</a> <a href="/tags/%E8%B5%84%E8%AE%AF%E8%81%9A%E5%90%88/" style="font-size: 10px;">资讯聚合</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 10px;">软件</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90/" style="font-size: 10px;">软件推荐</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E7%AE%A1%E7%90%86/" style="font-size: 10px;">软件管理</a> <a href="/tags/%E9%A9%B1%E5%8A%A8%E6%9B%B4%E6%96%B0/" style="font-size: 10px;">驱动更新</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(10);
        var tags_length = parseInt(132);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">二月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">一月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">七月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">六月 2024</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a><span class="archive-list-count">23</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">四月 2024</a><span class="archive-list-count">24</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


<style>
.nexmoe-widget .archive-list-count{
	position : absolute;
	right: 15px;
	top:9px;
	color: #DDD;
}
</style>

  
</aside>
	 <div class="nexmoe-copyright">
			
			<div style="font-size: 12px">
				<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
				本站总访问量<a id="busuanzi_value_site_pv"></a> 次<br />
				本站访客数<a id="busuanzi_value_site_uv"></a>人次<br />
			</div>
			
			<a href="https://beian.miit.gov.cn/" rel="external nofollow noreferrer" target="_blank">鄂ICP备2021017800号-1</a><br/>
			
			
	</div>
 

</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    
        <div class="nexmoe-post-cover" style="padding-bottom: 30%">
            <img data-src="/images/background/18.webp" data-sizes="auto" alt="iot-dc3阅读笔记" class="lazyload">
            <h1>iot-dc3阅读笔记</h1>
        </div>
    

        <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2024年07月01日</a>
    <a><i class="nexmoefont icon-areachart"></i>4.5k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 21 分钟</a>
</div>

        <div class="nexmoe-post-right">
            
                <div class="nexmoe-fixed">
                    <div class="nexmoe-valign">
                        <div class="nexmoe-toc">
                            
                            
                                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80"><span class="toc-number">1.</span> <span class="toc-text">地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">目录结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E4%B8%AD%E5%BF%83%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">平台中心模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E5%85%AC%E5%85%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">平台公共模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97"><span class="toc-number">2.3.</span> <span class="toc-text">平台驱动模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%88%E6%9D%83%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">授权模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B"><span class="toc-number">3.1.</span> <span class="toc-text">登录流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Token-%E7%94%9F%E6%88%90"><span class="toc-number">3.2.</span> <span class="toc-text">Token 生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Token%E6%A0%A1%E9%AA%8C"><span class="toc-number">3.3.</span> <span class="toc-text">Token校验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86"><span class="toc-number">4.</span> <span class="toc-text">数据采集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E9%85%8D%E7%BD%AE"><span class="toc-number">4.1.</span> <span class="toc-text">驱动程序配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">4.2.</span> <span class="toc-text">接收数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%85%A5%E5%BA%93"><span class="toc-number">4.3.</span> <span class="toc-text">数据入库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA"><span class="toc-number">4.4.</span> <span class="toc-text">数据展示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">数据可视化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E5%B1%95%E7%A4%BA"><span class="toc-number">5.1.</span> <span class="toc-text">状态展示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A8%E9%80%81%E6%9C%BA%E5%88%B6"><span class="toc-number">5.1.1.</span> <span class="toc-text">推送机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E6%9C%BA%E5%88%B6"><span class="toc-number">5.1.2.</span> <span class="toc-text">拉取机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81"><span class="toc-number">5.1.3.</span> <span class="toc-text">核心代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA-1"><span class="toc-number">5.2.</span> <span class="toc-text">数据展示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A8%E9%80%81%E6%9C%BA%E5%88%B6-1"><span class="toc-number">5.2.1.</span> <span class="toc-text">推送机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96%E6%9C%BA%E5%88%B6-1"><span class="toc-number">5.2.2.</span> <span class="toc-text">拉取机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81-1"><span class="toc-number">5.2.3.</span> <span class="toc-text">核心代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E4%B8%8B%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text">指令下置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81-2"><span class="toc-number">6.1.</span> <span class="toc-text">核心代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MQ%E8%AE%A2%E9%98%85%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.</span> <span class="toc-text">MQ订阅设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Modbus%E5%AE%9E%E7%8E%B0"><span class="toc-number">8.</span> <span class="toc-text">Modbus实现</span></a></li></ol>
                            
                        </div>
                    </div>
                </div>
            
        </div>

    <!-- 找到这里，添加代码 -->
  
    
    <div class="notice" >
        <i class="fa fa-bookmark"></i>
        <div class="notice-content">小卖铺上新啦!ChatGPT账号大甩卖! <a href=https://shop.wangwangit.com>一键直达</a></div>
    </div>
    
    
    <style>
.notice {
  padding: 20px;
  border: none; /* 去除边框 */
  color: #fff; /* 修改文字颜色 */
  position: relative;
  display: inline-block;
  width: 100%;
  background: #1a1a1a; /* 修改背景颜色 */
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* 添加阴影效果 */
  background-image: linear-gradient(45deg, #56dfae, #632b77); /* 添加背景渐变 */

}

.notice i {
  float: left;
  color: #999;
  font-size: 18px;
  padding-right: 10px;
  vertical-align: middle;
  margin-top: 3px;
}

.notice-content {
  display: initial;
  vertical-align: middle;
}
</style>
    
  <!-- 到这里结束 -->
        <article>
            <h2 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/pnoker/iot-dc3">pnoker&#x2F;iot-dc3</a></p>
<p><strong>DC3 是基于 Spring Cloud 的开源可分布式物联网 (IOT) 平台,用于快速开发, 部署物联设备接入项目,是一整套物联系统解决方案。</strong></p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><pre><code>.
├── dc3 资源文件,如sh,sql等
├── dc3-api gRpc定义的接口结构
├── dc3-center 平台中心模块
├── dc3-common 平台公共模块
├── dc3-driver 平台驱动模块
├── dc3-driver-sdk 平台驱动SDK模块
└── dc3-gateway 平台网关模块
</code></pre>
<h3 id="平台中心模块"><a href="#平台中心模块" class="headerlink" title="平台中心模块"></a>平台中心模块</h3><pre><code>.
├── dc3-center-auth 授权模块,主要负责接口权限
├── dc3-center-data 数据模块,主要负责驱动数据处理
└── dc3-center-manager 管理模块
</code></pre>
<h3 id="平台公共模块"><a href="#平台公共模块" class="headerlink" title="平台公共模块"></a>平台公共模块</h3><pre><code>.
├── dc3 git脚本
├── dc3-common-api api
├── dc3-common-auth 授权相关
├── dc3-common-constant 常量相关
├── dc3-common-exception 异常相关
├── dc3-common-influxdata influxDataDB相关
├── dc3-common-log 日志相关
├── dc3-common-model 模型相关
├── dc3-common-mongo mongoDB相关
├── dc3-common-mqtt mqtt相关
├── dc3-common-mysql 数据库相关
├── dc3-common-public 公共配置相关
├── dc3-common-quartz 定时任务
├── dc3-common-rabbitmq 消息队列相关
├── dc3-common-redis 缓存相关
├── dc3-common-thread 线程相关
└── dc3-common-web web服务配置
</code></pre>
<h3 id="平台驱动模块"><a href="#平台驱动模块" class="headerlink" title="平台驱动模块"></a>平台驱动模块</h3><pre><code>├── dc3-driver-dtu-yeecom Dtu驱动相关
├── dc3-driver-edge-gateway 边缘网关相关
├── dc3-driver-listening-virtual 虚拟网关相关
├── dc3-driver-lwm2m Lwm2m&amp;Coap相关
├── dc3-driver-modbus-tcp modbusTcp相关
├── dc3-driver-mqtt mqtt相关
├── dc3-driver-opc-da opc-da相关
├── dc3-driver-opc-ua opc-ua相关
├── dc3-driver-plcs7 plcs7相关
├── dc3-driver-virtual 测试驱动相关
└── dc3-driver-weather-amap 高德地图天气相关
</code></pre>
<h2 id="授权模块"><a href="#授权模块" class="headerlink" title="授权模块"></a>授权模块</h2><p>授权中心模块（dc3-center-auth）负责管理平台的登录授权功能，包括：</p>
<ul>
<li><strong>用户管理</strong>: 包括用户的增删改查，以及密码重置等操作。</li>
<li><strong>租户管理</strong>: 包括租户的增删改查，以及租户与用户绑定关系的管理。</li>
<li><strong>IP 黑名单</strong>: 维护 IP 黑名单，限制非法 IP 的访问。</li>
<li><strong>令牌管理</strong>: 生成、校验和注销用户的 Token 令牌，实现基于 Token 的身份验证。</li>
</ul>
<h3 id="登录流程"><a href="#登录流程" class="headerlink" title="登录流程"></a>登录流程</h3><ol>
<li><strong>获取租户信息</strong>： 网关从请求头中获取租户信息，并调用 TenantApi 查询租户是否存在且已启用。</li>
<li><strong>获取用户信息</strong>： 网关从请求头中获取用户登录名称，并调用 UserLoginApi 查询用户是否存在且已启用。</li>
<li><strong>校验 Token</strong>: 网关从请求头中获取 Token 信息，并调用 TokenApi 校验 Token 是否有效。</li>
<li><strong>设置用户信息</strong>: 如果 Token 校验通过，网关会将用户信息设置到请求头中，并转发到下游服务。</li>
</ol>
<pre><code class="java">// AuthenticGatewayFilterFactory.java
@Component
static class AuthenticGatewayFilter implements GatewayFilter &#123;

    @Override
    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) &#123;
        ServerHttpRequest request = exchange.getRequest();

        try &#123;
            // 1. 获取租户信息
            String tenantHeader = GatewayUtil.getRequestHeader(request, RequestConstant.Header.X_AUTH_TENANT);
            String tenant = DecodeUtil.byteToString(DecodeUtil.decode(tenantHeader));
            // ... 校验租户

            // 2. 获取用户信息
            String userHeader = GatewayUtil.getRequestHeader(request, RequestConstant.Header.X_AUTH_LOGIN);
            String user = DecodeUtil.byteToString(DecodeUtil.decode(userHeader));
            // ... 校验用户

            // 3. 校验 Token
            String tokenHeader = GatewayUtil.getRequestHeader(request, RequestConstant.Header.X_AUTH_TOKEN);
            // ... 解析 Token 信息
            // ... 校验 Token 是否有效

            // 4. 设置用户信息
            ServerHttpRequest build = request.mutate().headers(
                httpHeader -&gt; &#123;
                    // ... 设置用户信息到请求头
                &#125;
            ).build();

            exchange.mutate().request(build).build();
        &#125; catch (Exception e) &#123;
            // ... 处理异常
        &#125;

        return chain.filter(exchange);
    &#125;
&#125;
</code></pre>
<h3 id="Token-生成"><a href="#Token-生成" class="headerlink" title="Token 生成"></a>Token 生成</h3><p>用户登录时，会调用 TokenController 的 generateToken 接口生成 Token，具体实现步骤如下：</p>
<ol>
<li><strong>生成随机盐值</strong>: 调用 TokenService 的 generateSalt 方法生成一个随机盐值，并将其缓存到 Redis 中，有效期为 5 分钟。</li>
<li><strong>生成 Token</strong>: 调用 KeyUtil 的 generateToken 方法生成 Token，使用 JWT 算法，并将用户名、盐值和租户 ID 作为 payload，盐值作为密钥进行签名，有效期为 12 小时。</li>
<li><strong>缓存 Token</strong>: 将生成的 Token 缓存到 Redis 中，Key 为 PrefixConstant.USER + SuffixConstant.TOKEN + SymbolConstant.DOUBLE_COLON + username + SymbolConstant.HASHTAG + tenant.getId()，有效期为 12 小时。</li>
</ol>
<pre><code class="java">// TokenController.java
@Slf4j
@RestController
@RequestMapping(AuthServiceConstant.TOKEN_URL_PREFIX)
public class TokenController &#123;

    @Resource
    private TokenService tokenService;

    @PostMapping(&quot;/generate&quot;)
    public R&lt;String&gt; generateToken(@Validated(Auth.class) @RequestBody Login login) &#123;
        String token = tokenService.generateToken(login.getName(), login.getSalt(), login.getPassword(), login.getTenant());
        return ObjectUtil.isNotNull(token) ? R.ok(token, &quot;The token will expire in 12 hours.&quot;) : R.fail();
    &#125;
&#125;

// TokenServiceImpl.java
@Slf4j
@Service
public class TokenServiceImpl implements TokenService &#123;

    @Override
    public String generateToken(String username, String salt, String password, String tenantName) &#123;
        // ... 校验用户信息

        String redisTokenKey = PrefixConstant.USER + SuffixConstant.TOKEN + SymbolConstant.DOUBLE_COLON + username + SymbolConstant.HASHTAG + tenant.getId();
        String token = KeyUtil.generateToken(username, redisSaltValue, tenant.getId());
        redisUtil.setKey(redisTokenKey, token, TimeoutConstant.TOKEN_CACHE_TIMEOUT, TimeUnit.HOURS);
        return token;
    &#125;
&#125;
</code></pre>
<h3 id="Token校验"><a href="#Token校验" class="headerlink" title="Token校验"></a>Token校验</h3><p>网关在收到请求时，会调用 TokenApi 的 checkTokenValid 接口校验 Token，具体实现步骤如下：</p>
<ol>
<li><strong>从 Redis 中获取 Token</strong>: 根据用户名和租户 ID 从 Redis 中获取 Token。</li>
<li><strong>解析 Token</strong>: 调用 KeyUtil 的 parserToken 方法解析 Token，并校验签名是否正确。</li>
<li><strong>判断 Token 是否过期</strong>: 如果 Token 未过期，返回 Token 的过期时间。</li>
</ol>
<pre><code class="java">// TokenApi.java
@Slf4j
@GrpcService
public class TokenApi extends TokenApiGrpc.TokenApiImplBase &#123;

    @Override
    public void checkTokenValid(LoginQuery request, StreamObserver&lt;RTokenDTO&gt; responseObserver) &#123;
        // ...
        TokenValid select = tokenService.checkTokenValid(request.getName(), request.getSalt(), request.getToken(), request.getTenant());
        if (ObjectUtil.isNull(select)) &#123;
            // ...
        &#125; else if (!select.isValid()) &#123;
            // ...
        &#125; else &#123;
            String expireTime = TimeUtil.completeFormat(select.getExpireTime());
            // ...
        &#125;

        // ...
    &#125;
&#125;

// TokenServiceImpl.java
@Slf4j
@Service
public class TokenServiceImpl implements TokenService &#123;

    @Override
    public TokenValid checkTokenValid(String username, String salt, String token, String tenantName) &#123;
        // ...
        String redisKey = PrefixConstant.USER + SuffixConstant.TOKEN + SymbolConstant.DOUBLE_COLON + username + SymbolConstant.HASHTAG + tenant.getId();
        String redisToken = redisUtil.getKey(redisKey);
        // ...
        try &#123;
            Claims claims = KeyUtil.parserToken(username, salt, token, tenant.getId());
            return new TokenValid(true, claims.getExpiration());
        &#125; catch (Exception e) &#123;
            return new TokenValid(false, null);
        &#125;
    &#125;
&#125;
</code></pre>
<h2 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h2><p>我们以 MQTT 驱动为例，讲解一下数据从采集到入库再到展示的完整流程。</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702151346536.png" alt="image-20240702151346536" class="lazyload"></p>
<h3 id="驱动程序配置"><a href="#驱动程序配置" class="headerlink" title="驱动程序配置"></a>驱动程序配置</h3><p>MQTT 驱动程序（dc3-driver-mqtt）需要在配置文件中配置以下信息：</p>
<ul>
<li><strong>MQTT Broker 地址</strong>: 用于连接 MQTT Broker。</li>
<li><strong>驱动属性</strong>: 定义驱动程序自身的属性，例如连接超时时间、重连次数等。</li>
<li><strong>位号属性</strong>: 定义驱动程序支持的位号属性，例如读写权限、数据类型、单位等。</li>
<li><strong>订阅主题</strong>: 用于接收设备上报数据的主题。</li>
<li><strong>发布主题</strong>: 用于向设备发送指令的主题。</li>
</ul>
<h3 id="接收数据"><a href="#接收数据" class="headerlink" title="接收数据"></a>接收数据</h3><p>MQTT 驱动程序通过订阅主题接收设备上报的数据，具体实现步骤如下：</p>
<ol>
<li><strong>连接 MQTT Broker</strong>: 驱动程序启动时，会连接到配置的 MQTT Broker。</li>
<li><strong>订阅主题</strong>: 连接成功后，驱动程序会订阅配置文件中配置的主题。</li>
<li><strong>接收消息</strong>: 当设备向订阅主题发布消息时，驱动程序会接收到消息，并将其解析成 PointValue 对象。</li>
<li><strong>发送数据</strong>: 调用 DriverSenderService 的 pointValueSender 方法将 PointValue 对象发送到数据中心模块。</li>
</ol>
<pre><code class="java">// MqttReceiveHandler.java
@Slf4j
@Component
public class MqttReceiveHandler &#123;

    // ...

    @Bean
    @ServiceActivator(inputChannel = &quot;mqttInboundChannel&quot;)
    public MessageHandler mqttInboundReceive() &#123;
        return message -&gt; &#123;
            // ...
            
            MessageHeader messageHeader = new MessageHeader(message.getHeaders());
            String payload = message.getPayload().toString();
            // ... 校验消息

            MqttScheduleJob.messageCount.getAndIncrement();
            MqttMessage mqttMessage = new MqttMessage(messageHeader, payload);
            // ...

            // ... 根据数据量判断是否批量处理

            threadPoolExecutor.execute(() -&gt; mqttReceiveService.receiveValue(mqttMessage));
            // ...
        &#125;;
    &#125;
&#125;

// MqttReceiveServiceImpl.java
@Slf4j
@Service
public class MqttReceiveServiceImpl implements MqttReceiveService &#123;

    @Override
    public void receiveValue(MqttMessage mqttMessage) &#123;
        // do something to process your mqtt messages
        log.info(JsonUtil.toPrettyJsonString(mqttMessage));
        PointValue pointValue = JsonUtil.parseObject(mqttMessage.getPayload(), PointValue.class);
        pointValue.setOriginTime(new Date());
        driverSenderService.pointValueSender(pointValue);
    &#125;

    // ...
&#125;
</code></pre>
<h3 id="数据入库"><a href="#数据入库" class="headerlink" title="数据入库"></a>数据入库</h3><p>数据中心模块（dc3-center-data）需要在配置文件中配置数据存储策略，例如：</p>
<ul>
<li><strong>存储方式</strong>: 支持 Redis、MongoDB、InfluxDB、TDengine、OpenTSDB、Elasticsearch 等多种存储方式。</li>
<li><strong>批量处理速度</strong>: 当数据采集速度超过该值时，启用批量处理机制。</li>
<li><strong>批量处理间隔</strong>: 批量处理的时间间隔。</li>
</ul>
<pre><code class="java">// PointValueReceiver.java
@Slf4j
@Component
public class PointValueReceiver &#123;

    // ...

    @RabbitHandler
    @RabbitListener(queues = &quot;#&#123;pointValueQueue.name&#125;&quot;)
    public void pointValueReceive(Channel channel, Message message, PointValue pointValue) &#123;
        try &#123;
            channel.basicAck(message.getMessageProperties().getDeliveryTag(), true);
            // ... 校验数据

            PointValueScheduleJob.valueCount.getAndIncrement();
            log.debug(&quot;Point value, From: &#123;&#125;, Received: &#123;&#125;&quot;, message.getMessageProperties().getReceivedRoutingKey(), pointValue);

            // ... 根据数据量判断是否批量处理

            threadPoolExecutor.execute(() -&gt; pointValueService.savePointValue(pointValue));
            // ...
        &#125; catch (Exception e) &#123;
            log.error(e.getMessage(), e);
        &#125;
    &#125;
&#125;

// PointValueServiceImpl.java
@Slf4j
@Service
public class PointValueServiceImpl implements PointValueService &#123;

    // ...

    @Override
    public void savePointValue(PointValue pointValue) &#123;
        // ... 校验数据

        pointValue.setCreateTime(new Date());
        repositoryHandleService.save(pointValue);
    &#125;

    // ...
&#125;

// RepositoryHandleServiceImpl.java
@Slf4j
@Service
public class RepositoryHandleServiceImpl implements RepositoryHandleService &#123;

    // ...

    @Override
    public void save(PointValue pointValue) &#123;
        // 保存单个数据到 Redis &amp; Mongo
        savePointValueToRepository(pointValue, redisRepositoryService, mongoRepositoryService);

        // ... 根据配置选择存储服务

    &#125;

    // ...
&#125;
</code></pre>
<h3 id="数据展示"><a href="#数据展示" class="headerlink" title="数据展示"></a>数据展示</h3><p>用户可以通过平台提供的 API 接口查询设备数据，具体实现步骤如下：</p>
<ol>
<li><strong>发送请求</strong>: 用户通过平台 API 接口发送数据查询请求。</li>
<li><strong>接收请求</strong>: 数据中心模块接收到请求后，解析请求参数，例如设备 ID、位号 ID、时间范围等。</li>
<li><strong>查询数据</strong>: 根据请求参数，从数据库中查询数据。</li>
<li><strong>返回数据</strong>: 将查询到的数据返回给用户。</li>
</ol>
<pre><code class="java">// PointValueController.java
@Slf4j
@RestController
@RequestMapping(DataServiceConstant.VALUE_URL_PREFIX)
public class PointValueController &#123;

    // ...

    @PostMapping(&quot;/latest&quot;)
    public R&lt;Page&lt;PointValue&gt;&gt; latest(@RequestBody PointValuePageQuery pointValuePageQuery) &#123;
        // ...
        Page&lt;PointValue&gt; page = pointValueService.latest(pointValuePageQuery);
        // ...
    &#125;

    // ...
&#125;

// PointValueServiceImpl.java
@Slf4j
@Service
public class PointValueServiceImpl implements PointValueService &#123;

    // ...

    @Override
    public Page&lt;PointValue&gt; latest(PointValuePageQuery pageQuery) &#123;
        // ...
        // 查询实时数据
        List&lt;PointValue&gt; pointValues = realtime(pageQuery.getDeviceId(), pointIds);
        if (CollUtil.isEmpty(pointValues)) &#123;
            // 查询最近数据
            pointValues = latest(pageQuery.getDeviceId(), pointIds);
        &#125;
        // ...

        // ... 查询历史数据
    &#125;

    // ...
&#125;
</code></pre>
<h2 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h2><p>平台可以提供数据可视化功能，将查询到的数据以图表等形式展示给用户，例如：</p>
<ul>
<li><strong>实时曲线</strong>: 展示位号值的实时变化趋势。</li>
<li><strong>历史曲线</strong>: 展示位号值在一段时间内的变化趋势。</li>
<li><strong>报表</strong>: 以表格形式展示位号值。<h3 id="状态展示"><a href="#状态展示" class="headerlink" title="状态展示"></a>状态展示</h3></li>
</ul>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702154506368.png" alt="image-20240702154506368" class="lazyload"></p>
<p><strong>图解说明:</strong></p>
<ol>
<li><strong>驱动程序定时发送设备状态事件消息</strong>: 驱动程序会定期执行定时任务，读取设备的实时状态，并将其封装成 DeviceEvent 对象，通过 RabbitMQ 的事件交换机发送到数据中心。</li>
<li><strong>数据中心接收并处理设备状态事件消息</strong>: 数据中心模块订阅了事件交换机的消息，接收到设备状态事件消息后，会将设备状态信息写入 Redis，Key 为 device_status:{deviceId}，并设置过期时间。</li>
<li><strong>前端页面请求设备状态</strong>: 前端页面通过 AJAX 等方式请求数据中心的 API 接口，获取设备的实时状态信息。</li>
<li><strong>数据中心从 Redis 中读取并返回设备状态</strong>: 数据中心模块接收到前端请求后，从 Redis 中读取设备状态信息，并将其返回给前端页面。</li>
</ol>
<h4 id="推送机制"><a href="#推送机制" class="headerlink" title="推送机制"></a>推送机制</h4><ul>
<li>驱动程序定期读取设备状态，并通过 RabbitMQ 推送到数据中心。</li>
<li>数据中心接收到状态信息后，更新 Redis 中的缓存数据。</li>
</ul>
<h4 id="拉取机制"><a href="#拉取机制" class="headerlink" title="拉取机制"></a>拉取机制</h4><ul>
<li>前端页面定期轮询数据中心 API 接口，获取最新的设备状态信息。</li>
</ul>
<h4 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h4><p>1.驱动程序定时发送设备状态</p>
<pre><code class="java">// DriverCustomServiceImpl.java
@Slf4j
@Service
public class DriverCustomServiceImpl implements DriverCustomService &#123;

    // ...

    @Override
    public void schedule() &#123;
        // 定时任务逻辑，例如每隔 10 秒执行一次
        driverContext.getDriverMetadata().getDeviceMap().keySet()
                .forEach(id -&gt; driverSenderService.deviceEventSender(new DeviceEvent(id, EventConstant.Device.STATUS, DeviceStatusEnum.ONLINE, 25, TimeUnit.SECONDS)));
    &#125;

    // ...
&#125;
</code></pre>
<p>2.数据中心接收和处理设备状态事件</p>
<pre><code class="java">// DeviceEventReceiver.java
@Slf4j
@Component
public class DeviceEventReceiver &#123;

    // ...

    @RabbitHandler
    @RabbitListener(queues = &quot;#&#123;deviceEventQueue.name&#125;&quot;)
    public void deviceEventReceive(Channel channel, Message message, DeviceEvent deviceEvent) &#123;
        // ...

        switch (deviceEvent.getType()) &#123;
            case EventConstant.Device.STATUS:
                redisUtil.setKey(
                        PrefixConstant.DEVICE_STATUS_KEY_PREFIX + deviceEvent.getDeviceId(),
                        deviceEvent.getContent(),
                        deviceEvent.getTimeOut(),
                        deviceEvent.getTimeUnit()
                );
                break;
            // ...
        &#125;

        // ...
    &#125;
&#125;
</code></pre>
<p>3.前端请求设备状态</p>
<pre><code class="java">// 前端代码示例，使用 AJAX 请求数据
setInterval(function() &#123;
  $.ajax(&#123;
    url: &#39;/data/device/status/device&#39;,
    type: &#39;GET&#39;,
    success: function(data) &#123;
      // 更新页面上的设备状态信息
      // ...
    &#125;
  &#125;);
&#125;, 1000); // 每隔 1 秒请求一次
</code></pre>
<h3 id="数据展示-1"><a href="#数据展示-1" class="headerlink" title="数据展示"></a>数据展示</h3><p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702154521066.png" alt="image-20240702154521066" class="lazyload"></p>
<p><strong>图解说明:</strong></p>
<ol>
<li><strong>驱动程序读取设备数据</strong>: 驱动程序会定期执行定时任务，读取设备的实时数据，并将其封装成 PointValue 对象。</li>
<li><strong>驱动程序发送设备数据消息</strong>: 驱动程序将 PointValue 对象通过 RabbitMQ 的数据交换机发送到数据中心。</li>
<li><strong>数据中心接收并处理设备数据消息</strong>: 数据中心模块订阅了数据交换机的消息，接收到设备数据消息后，会进行以下操作：<ul>
<li>将 PointValue 对象写入 Redis，Key 为 realtime_value:{deviceId}.{pointId}，用于实时数据展示。</li>
<li>将 PointValue 对象写入 MongoDB，用于存储历史数据。</li>
</ul>
</li>
<li><strong>前端页面请求设备实时数据</strong>: 前端页面通过 AJAX 等方式请求数据中心的 API 接口，获取设备的实时数据。</li>
<li><strong>数据中心从 Redis 中读取并返回设备实时数据</strong>: 数据中心模块接收到前端请求后，从 Redis 中读取设备实时数据，并将其返回给前端页面。</li>
</ol>
<h4 id="推送机制-1"><a href="#推送机制-1" class="headerlink" title="推送机制"></a>推送机制</h4><ul>
<li>驱动程序定期读取设备数据，并通过 RabbitMQ 推送到数据中心。</li>
<li>数据中心接收到数据后，更新 Redis 和 MongoDB 中的缓存数据。</li>
</ul>
<h4 id="拉取机制-1"><a href="#拉取机制-1" class="headerlink" title="拉取机制"></a>拉取机制</h4><ul>
<li>前端页面定期轮询数据中心 API 接口，获取最新的设备数据。</li>
</ul>
<h4 id="核心代码-1"><a href="#核心代码-1" class="headerlink" title="核心代码"></a>核心代码</h4><p>1.驱动程序读取并发送设备数据</p>
<pre><code>// DriverReadScheduleJob.java
@Slf4j
@Component
public class DriverReadScheduleJob extends QuartzJobBean &#123;
    
    // ...

    @Override
    protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException &#123;
        // ... 遍历设备和位号

        threadPoolExecutor.execute(() -&gt; driverCommandService.read(device.getId(), pointId));

        // ...
    &#125;
&#125;

// DriverCommandServiceImpl.java
@Slf4j
@Service
public class DriverCommandServiceImpl implements DriverCommandService &#123;

    // ...

    @Override
    public PointValue read(String deviceId, String pointId) &#123;
        // ... 获取设备和位号信息

        try &#123;
            // 调用驱动自定义 read 方法读取数据
            String rawValue = driverCustomService.read(
                // ...
            );

            // ... 校验数据

            PointValue pointValue = new PointValue(deviceId, pointId, rawValue, ConvertUtil.convertValue(point, rawValue));
            driverSenderService.pointValueSender(pointValue);
            return pointValue;
        &#125; catch (Exception e) &#123;
            // ... 处理异常
        &#125;
    &#125;
    
    // ...
&#125;
</code></pre>
<p>2.数据中心接收和处理设备数据</p>
<pre><code class="java">// PointValueReceiver.java
@Slf4j
@Component
public class PointValueReceiver &#123;

    // ...

    @RabbitHandler
    @RabbitListener(queues = &quot;#&#123;pointValueQueue.name&#125;&quot;)
    public void pointValueReceive(Channel channel, Message message, PointValue pointValue) &#123;
        // ...

        // ... 根据数据量判断是否批量处理

        threadPoolExecutor.execute(() -&gt; pointValueService.savePointValue(pointValue));

        // ...
    &#125;
&#125;

// PointValueServiceImpl.java
@Slf4j
@Service
public class PointValueServiceImpl implements PointValueService &#123;

    // ...

    @Override
    public void savePointValue(PointValue pointValue) &#123;
        // ...
        pointValue.setCreateTime(new Date());
        repositoryHandleService.save(pointValue);
    &#125;

    // ...
&#125;

// RepositoryHandleServiceImpl.java
@Slf4j
@Service
public class RepositoryHandleServiceImpl implements RepositoryHandleService &#123;

    // ...

    @Override
    public void save(PointValue pointValue) &#123;
        // 保存单个数据到 Redis &amp; Mongo
        savePointValueToRepository(pointValue, redisRepositoryService, mongoRepositoryService);

        // ... 根据配置选择其他存储服务
    &#125;

    // ...
&#125;
</code></pre>
<p>3.前端请求示例</p>
<pre><code class="java">// 前端代码示例，使用 AJAX 请求数据
setInterval(function() &#123;
  $.ajax(&#123;
    url: &#39;/data/point_value/latest&#39;, // 假设 API 接口为 /data/point_value/latest
    type: &#39;POST&#39;,
    data: JSON.stringify(&#123; deviceId: &#39;device1&#39; &#125;), // 假设需要查询 deviceId 为 device1 的设备数据
    success: function(data) &#123;
      // 更新页面上的设备数据
      // ...
    &#125;
  &#125;);
&#125;, 1000); // 每隔 1 秒请求一次
</code></pre>
<h2 id="指令下置"><a href="#指令下置" class="headerlink" title="指令下置"></a>指令下置</h2><p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702160343549.png" alt="image-20240702160343549" class="lazyload"></p>
<p><strong>图解说明:</strong></p>
<ol>
<li><strong>用户发送指令下置请求</strong>: 用户通过平台 API 接口发送指令下置请求，例如控制设备开关、设置参数等。</li>
<li><strong>平台网关查询驱动信息</strong>: 平台网关接收到请求后，调用设备管理中心 API 接口，查询该设备绑定的驱动程序信息，例如驱动程序服务名。</li>
<li><strong>平台网关将指令下发到 RabbitMQ</strong>: 平台网关将指令内容封装成 DeviceCommandDTO 对象，并将其发送到 RabbitMQ 的指令交换机，RoutingKey 为 dc3.r.command.device.{driverServiceName}，例如 dc3.r.command.device.dc3-driver-modbus-tcp。</li>
<li><strong>驱动程序接收指令消息</strong>: 驱动程序订阅了指令交换机上的对应主题，接收到指令消息后，解析指令内容，例如设备 ID、位号 ID、指令类型、指令参数等。</li>
<li><strong>驱动程序将指令发送到设备</strong>: 驱动程序根据解析出的指令内容，通过对应的驱动协议将指令发送到设备。</li>
</ol>
<h3 id="核心代码-2"><a href="#核心代码-2" class="headerlink" title="核心代码"></a>核心代码</h3><p>1.平台网关发送指令</p>
<pre><code class="java">// PointValueCommandController.java
@Slf4j
@RestController
@RequestMapping(DataServiceConstant.VALUE_COMMAND_URL_PREFIX)
public class PointValueCommandController &#123;

    // ...

    @PostMapping(&quot;/write&quot;)
    public R&lt;Boolean&gt; write(@Validated @RequestBody PointValueWriteVO entityVO) &#123;
        // ...

        DeviceCommandDTO.DeviceWrite deviceWrite = new DeviceCommandDTO.DeviceWrite(entityVO.getDeviceId(), entityVO.getPointId(), entityVO.getValue());
        DeviceCommandDTO deviceCommandDTO = new DeviceCommandDTO(DeviceCommandTypeEnum.WRITE, JsonUtil.toJsonString(deviceWrite));
        rabbitTemplate.convertAndSend(RabbitConstant.TOPIC_EXCHANGE_COMMAND, RabbitConstant.ROUTING_DEVICE_COMMAND_PREFIX + rDriverDTO.getData().getServiceName(), deviceCommandDTO);

        // ...
    &#125;

    // ...
&#125;
</code></pre>
<p>2.驱动程序接收指令</p>
<pre><code class="java">// DeviceCommandReceiver.java
@Slf4j
@Component
public class DeviceCommandReceiver &#123;

    // ...

    @RabbitHandler
    @RabbitListener(queues = &quot;#&#123;deviceCommandQueue.name&#125;&quot;)
    public void deviceCommandReceive(Channel channel, Message message, DeviceCommandDTO entityDTO) &#123;
        // ...

        switch (entityDTO.getType()) &#123;
            case WRITE:
                driverCommandService.write(entityDTO);
                break;
            // ...
        &#125;

        // ...
    &#125;
&#125;

// DriverCommandServiceImpl.java
@Slf4j
@Service
public class DriverCommandServiceImpl implements DriverCommandService &#123;

    // ...

    @Override
    public void write(DeviceCommandDTO commandDTO) &#123;
        // ... 解析指令内容

        log.info(&quot;Start command of write: &#123;&#125;&quot;, JsonUtil.toPrettyJsonString(commandDTO));
        Boolean write = write(deviceWrite.getDeviceId(), deviceWrite.getPointId(), deviceWrite.getValue()); // 调用驱动程序自定义的 write 方法
        log.info(&quot;End command of write: write &#123;&#125;&quot;, write);
    &#125;

    // ...
&#125;
</code></pre>
<h2 id="MQ订阅设计"><a href="#MQ订阅设计" class="headerlink" title="MQ订阅设计"></a>MQ订阅设计</h2><p>项目采用了一种层次化的主题命名规范，主要包含以下几个部分：</p>
<table>
<thead>
<tr>
<th>部分</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>应用标识</td>
<td>用于区分不同的应用，通常为 dc3</td>
<td>dc3</td>
</tr>
<tr>
<td>消息类型</td>
<td>用于区分不同的消息类型，例如事件、元数据、指令、数据</td>
<td>e (事件), m (元数据), c (指令), v (数据)</td>
</tr>
<tr>
<td>操作方向</td>
<td>用于区分消息的发送方和接收方，例如驱动、设备、平台</td>
<td>d (驱动), p (平台)</td>
</tr>
<tr>
<td>模块类型</td>
<td>用于区分不同的模块，例如驱动、设备</td>
<td>driver, device</td>
</tr>
<tr>
<td>服务名称</td>
<td>用于区分不同的服务，通常为驱动程序或设备的唯一标识</td>
<td>dc3-driver-mqtt</td>
</tr>
<tr>
<td>其他信息</td>
<td>可选，用于进一步区分消息，例如设备 ID、位号 ID 等</td>
<td>{deviceId}, {pointId}</td>
</tr>
</tbody></table>
<p>例如，驱动程序向数据中心发送设备状态事件消息，主题可以命名为：dc3&#x2F;e&#x2F;d&#x2F;device&#x2F;{driverServiceName}，其中：</p>
<ul>
<li>dc3： 应用标识</li>
<li>e： 事件消息类型</li>
<li>d： 驱动程序发送方向</li>
<li>device： 模块类型</li>
<li>{driverServiceName}： 驱动程序服务名称</li>
</ul>
<p>项目中，不同的模块会根据其功能和职责订阅不同的主题，以实现高效的消息传递和处理。</p>
<p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702161250757.png" alt="image-20240702161250757" class="lazyload"></p>
<p><strong>驱动程序:</strong></p>
<ul>
<li><strong>同步主题</strong>: 订阅 dc3&#x2F;sync&#x2F;d&#x2F;{driverClient} 主题，接收平台下发的同步指令。</li>
<li><strong>元数据主题</strong>: 订阅 dc3&#x2F;m&#x2F;p&#x2F;driver&#x2F;{driverService} 主题，接收平台下发的元数据更新指令。</li>
<li><strong>指令主题</strong>: 订阅 dc3&#x2F;c&#x2F;p&#x2F;driver&#x2F;{driverService} 和 dc3&#x2F;c&#x2F;p&#x2F;device&#x2F;{driverService} 主题，接收平台下发的指令。</li>
</ul>
<p><strong>数据中心:</strong></p>
<ul>
<li><strong>事件主题</strong>: 订阅 dc3&#x2F;e&#x2F;d&#x2F;* 主题，接收驱动程序上报的驱动和设备事件消息。</li>
<li><strong>数据主题</strong>: 订阅 dc3&#x2F;v&#x2F;d&#x2F;* 主题，接收驱动程序上报的设备数据消息。</li>
</ul>
<p><strong>平台网关:</strong></p>
<ul>
<li><strong>指令主题</strong>: 根据设备绑定的驱动程序，将指令发布到 dc3&#x2F;c&#x2F;p&#x2F;driver&#x2F;{driverServiceName} 或 dc3&#x2F;c&#x2F;p&#x2F;device&#x2F;{driverServiceName} 主题。</li>
</ul>
<h2 id="Modbus实现"><a href="#Modbus实现" class="headerlink" title="Modbus实现"></a>Modbus实现</h2><p><img data-fancybox="gallery" data-sizes="auto" data-src="https://i0.wp.com/wangwangit001.cachefly.net/wangwangit/image/master/img1/image-20240702163901323.png" alt="image-20240702163901323" class="lazyload"></p>

        </article>
       
        <div class="donate">
          <h3>觉得文章对你有帮助？请我喝杯咖啡吧！</h3>
          <button class="donate-button">赏</button>
        </div>
        
        <div class="payment-codes">
          <div class="code-container">
            <div class="wechat-code">
              <img src="/images/wechatpay.jpg" alt="微信支付码">
              <span>微信支付</span>
            </div>
            <div class="alipay-code">
              <img src="/images/alipay.jpg" alt="支付宝支付码">
              <span>支付宝支付</span>
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2114287505938813"
     crossorigin="anonymous"></script>
<!-- 广告 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2114287505938813"
     data-ad-slot="4342703831"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <style>
          .divider {
            height: 10px;
            background: linear-gradient(to right, #cf1e7e, #23527c);
          }
        
          .donate {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            border: none; /* 移除背景色 */
          }
        
          .donate-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 16px;
            color: #fff;
            background: linear-gradient(to right, #337ab7, #23527c);
            border: none;
            cursor: pointer;
          }
        
          .donate-button:hover {
            background: linear-gradient(to right, #23527c, #337ab7);
          }
        
          .payment-codes {
            display: none;
            padding-top: 20px; /* 调整上边距 */
          }
          
          .code-container {
            display: flex;
            justify-content: center;
          }
        
          .payment-codes .wechat-code,
          .payment-codes .alipay-code {
            margin: 0 10px;
            text-align: center;
          }
        
          .payment-codes img {
            width: 300px;
            height: 300px;
          }
        
          .payment-codes span {
            display: block;
            margin-top: 10px;
            font-size: 14px;
          }
        </style>
        
        <script>
          var donateButton = document.querySelector('.donate-button');
          var paymentCodes = document.querySelector('.payment-codes');
          var codeVisible = false;
        
          donateButton.addEventListener('click', function() {
            if (!codeVisible) {
              paymentCodes.style.display = 'block';
              codeVisible = true;
            } else {
              paymentCodes.style.display = 'none';
              codeVisible = false;
            }
          });
        </script>
          
        <!-- 
            
  <div class="nexmoe-post-copyright">
    <strong>本文作者：</strong>一只会飞的旺旺<br>
    
    <strong>本文链接：</strong><a href="https://www.wangwangit.com/iot-dc3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" title="https:&#x2F;&#x2F;www.wangwangit.com&#x2F;iot-dc3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;www.wangwangit.com&#x2F;iot-dc3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0&#x2F;</a><br>

    
      <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
    
  </div>


         -->

        <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/Java/">Java</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E7%89%A9%E8%81%94%E7%BD%91/" rel="tag">物联网</a>
    
</div>

    <div class="nexmoe-post-footer">
        <section class="nexmoe-comment">
    <div class="waline"></div>
<script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet' />
<script>
    // 使用方法 https://valine.js.org/quickstart.html
    Waline.init({
        el: '.waline',
        serverURL: 'https://blog-waline-nine-rho.vercel.app',
         // 设置 emoji 为微博与哔哩小黄脸
        emoji: [
        '//unpkg.com/@waline/emojis@1.2.0/weibo',
        '//unpkg.com/@waline/emojis@1.2.0/bmoji',
        '//unpkg.com/@waline/emojis@1.2.0/tw-emoji',
        ],
        reaction: true, // 开启反应
});
</script>
  
</section>
    </div>
</div>


        <div class="nexmoe-post-right">
          
            <div class="nexmoe-fixed">
              <div class="nexmoe-tool">
                <a href="#" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
              </div>
            </div>
          
        </div>
    </div>
  </div>
  <div id="nexmoe-pendant">
    
    
  </div>
  <script src="https://unpkg.com/lazysizes@5.1.0/lazysizes.min.js"></script>
<script src="https://cdn.staticfile.org/highlight.js/10.0.0/highlight.min.js"></script>
<script src="https://unpkg.com/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>

<script>
	hljs.initHighlightingOnLoad();
</script>

<script src="https://unpkg.com/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="/lib/fancybox/js/jquery.fancybox.min.js"></script>


<script src="/js/app.js?v=1741160487249"></script>

<script src="https://unpkg.com/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>

  
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ENFHSEQW2K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ENFHSEQW2K');
</script>






    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7a6812c7a8ad219e56fcc2f0397ea516";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<!-- hexo injector body_end start -->
<script src="https://unpkg.com/clipboard@2.0.8/dist/clipboard.min.js"></script>

<script src="/lib/codeBlock/codeBlockFuction.js"></script>

<script src="/lib/codeBlock/codeLang.js"></script>

<script src="/lib/codeBlock/codeCopy.js"></script>

<script src="/lib/codeBlock/codeShrink.js"></script>

<link rel="stylesheet" href="/lib/codeBlock/matery.css">

<script src="https://code.jquery.com/jquery-3.6.0.js"></script>

<script src="/js/search.js"></script>

<script src="/js/webapp.js"></script>
<!-- hexo injector body_end end --></body>
</html>

<script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/2c8d8bfb.js","daovoice")</script>
<script>
  daovoice('init', {
    app_id: "2c8d8bfb"
  });
  daovoice('update');
</script>

